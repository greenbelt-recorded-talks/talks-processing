{% extends 'base.html' %}

{% block content %}

<h1 class="uk-heading-line uk-text-center"><span>Talks</span></h1>

<div uk-filter="target: .js-filter">

    <div class="uk-grid-small uk-grid-divider uk-child-width-auto" uk-grid>
        <div>
            <ul class="uk-subnav uk-subnav-pill" uk-margin>
                <li class="uk-active" uk-filter-control><a href="#">All</a></li>
            </ul>
        </div>
        <div>
            <ul class="uk-subnav uk-subnav-pill" uk-margin>
		<li>RAW</li>
                <li uk-filter-control="filter: [data-has-raw='false']; group: raw"><a href="#">No</a></li>
		<li uk-filter-control="filter: [data-has-raw='true']; group: raw"><a href="#">Yes</a></li>
	    </ul>
	</div>
	<div>
            <ul class="uk-subnav uk-subnav-pill" uk-margin>
                <li>Edited</li>
                <li uk-filter-control="filter: [data-has-edited='false']; group: edited"><a href="#">No</a></li>
                <li uk-filter-control="filter: [data-has-edited='true']; group: edited"><a href="#">Yes</a></li>
            </ul>
        </div>
	<div>
            <ul class="uk-subnav uk-subnav-pill" uk-margin>
                <li>Snip</li>
                <li uk-filter-control="filter: [data-has-snip='false']; group: snip"><a href="#">No</a></li>
                <li uk-filter-control="filter: [data-has-snip='true']; group: snip"><a href="#">Yes</a></li>
            </ul>
        </div>
	<div>
            <ul class="uk-subnav uk-subnav-pill" uk-margin>
		<li>Processed</li>
                <li uk-filter-control="filter: [data-has-processed='false']; group: processed"><a href="#">No</a></li>
                <li uk-filter-control="filter: [data-has-processed='true']; group: processed"><a href="#">Yes</a></li>
            </ul>
        </div>
	<div>
            <ul class="uk-subnav uk-subnav-pill" uk-margin>
                <li>Priority</li>
                <li uk-filter-control="filter: [data-priority='false']; group: priority"><a href="#">Additional</a></li>
                <li uk-filter-control="filter: [data-priority='true']; group: priority"><a href="#">Priority</a></li>
            </ul>
        </div>
    </div>

<ul class="js-filter" uk-grid>

{% for talk in talks %}

{% set has_raw = "true" if 'gb' + gb_year + '-' + ('%03d' % talk.id)|string+ "_RAW.mp3" in raw_files else "false" %}
{% set has_edited = "true" if 'gb' + gb_year + '-' + ('%03d' % talk.id)|string+"_EDITED.mp3" in edited_files else "false" %}
{% set has_snip = "true" if 'gb' + gb_year + '-' + ('%03d' % talk.id)|string+"_SNIP.mp3" in snip_files else "false" %}
{% set has_processed = "true" if 'gb' + gb_year + '-' + ('%03d' % talk.id)|string+"mp3.mp3" in processed_files else "false" %}
{% set is_priority = "true" if talk["is_priority"] else "false" %} 


<li class="uk-card uk-card-body uk-card-default" data-has-raw="{{ has_raw }}" data-has-edited="{{ has_edited }}" data-has-snip="{{ has_snip }}" data-has-processed="{{ has_processed }}" data-priority="{{ is_priority }}" >
	<div class="uk-width-1-1">
		<h3 class="uk-card-title">{{ 'gb' + gb_year + '-' + ('%03d' % talk.id) }}: {{ talk.title }}</h3>
		<span class="uk-text-default uk-text-bold">{{ talk.speaker }}:</span>
		<span class="uk-text-default">{{ talk.description }}</span>

		<hr>

		<div class="uk-child-width-expand@s uk-text-center" uk-grid>

    			<div>
        			<div class="uk-card uk-card-default uk-card-body">
				<span>RAW</span>
					{% if has_raw == "true"  %}
        				<p><a href="{{ url_for("getfile", file_type="raw", talk_id=talk.id) }}">Download</a></p>
					{% endif %}

				<form method=post enctype=multipart/form-data name=upload_talk action=uploadtalk>
                			<input name=file type=file id=file accept=".mp3">
                			<input name=file_type type=hidden value="raw">
                			<input name=talk_id type=hidden value="{{talk.id}}">
                			<button>Upload</button>
        			</form>
			</div>
    		</div>
    		<div>
        		<div class="uk-card uk-card-default uk-card-body">
				<span>Edited</span>
				{% if has_edited == "true" %}
        			<p><a href="{{ url_for("getfile", file_type="edited", talk_id=talk.id) }}">Download</a></p>
        			{% endif %}

       				 <form method=post enctype=multipart/form-data name=upload_edited_talk action=uploadtalk>
                			<input name=file type=file id=file accept=".mp3">
                			<input name=file_type type=hidden value="edited">
                			<input name=talk_id type=hidden value="{{talk.id}}">
                			<button>Upload</button>
        			</form>
			</div>
    		</div>
    		<div>
        		<div class="uk-card uk-card-default uk-card-body">
				<span>Snip</span>
				{% if has_snip == "true" %}
        			<p><a href="{{ url_for("getfile", file_type="snip", talk_id=talk.id) }}">Download</a></p>
        			{% endif %}

        			<form method=post enctype=multipart/form-data name=upload_snip action=uploadtalk>
                			<input name=file type=file id=file accept=".mp3">
        	        		<input name=file_type type=hidden value="snip">
                			<input name=talk_id type=hidden value="{{talk.id}}">
     	        			<button>Upload</button>
        			</form>
			</div>
    		</div>
    		<div>
        		<div class="uk-card uk-card-default uk-card-body">
				<span>Processed</span>
				{% if has_processed == "true" %}
        			<p><a href="{{ url_for("getfile", file_type="processed", talk_id=talk.id) }}">Download</a></p>
        			{% endif %}
			</div>
    		</div>
	</div>
</div>
</li>

{% endfor %}

</ul>

</div>
</div>

{% endblock %}


