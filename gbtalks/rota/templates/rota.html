{% extends 'base.html' %}

{% block content %}


<h1 class="uk-heading-line uk-text-center"><span>Rota</span></h1>

<p>This page provides a way to create a new rota, a tabular view of the rota by venue, and a timeline view of the rota (scroll down!)</p>

<div class="uk-card uk-card-body uk-card-default">

<h1>Create New Rota</h1>

<p>Create a new rota, using the talks and recorders files already provided. This will always create the same rota for the same inputs. Small changes to the input files (e.g. adding a talk) can result in large changes to the rota. If there are any last-minute changes - particularly once rotas have been issued to recorders - these should be addressed manually. 

There is no way to update the online rota with manual changes, apart from by directly editing the database. If you need to do this, speak to Rob. 
</p>

<form method=post onsubmit="return confirmAndStartRota(this)">
	<button class="uk-button uk-button-primary" id="rotaButton">Create New Rota</button>
</form>

<div id="rotaProgress" class="uk-alert-primary" uk-alert style="display: none;">
    <div class="uk-flex uk-flex-middle">
        <div uk-spinner="ratio: 0.8" class="uk-margin-small-right"></div>
        <p class="uk-margin-remove">Generating rota... This may take a few moments.</p>
    </div>
</div>

<script>
function confirmAndStartRota(form) {
    if (confirm('Are you sure you want to create a new rota? This will clear all existing assignments and cannot be undone.')) {
        // Show progress indicator
        document.getElementById('rotaProgress').style.display = 'block';
        
        // Disable button and change text
        const button = document.getElementById('rotaButton');
        button.disabled = true;
        button.innerHTML = 'Generating...';
        button.className = 'uk-button uk-button-secondary';
        
        // Scroll to progress indicator
        document.getElementById('rotaProgress').scrollIntoView({ behavior: 'smooth' });
        
        return true; // Allow form submission
    }
    return false; // Cancel submission
}
</script>

</div>

<hr class="uk-divider-icon">

<div class="uk-card uk-card-body uk-card-default">

<h1>Print Rota</h1>

<h2>Rota by venue</h2>
<p>Provides a landscape, tabular view of the rota, with times across the top and venues down the side. On its own page for ease of printing:</p> 

<span><a href="{{ url_for('rota.rota_by_venue') }}">Rota by venue</a></span>

<h2>Rota by time</h2>

<p>Provides a vertical, tabular view of the rota, organised by time. On its own page for ease of printing:</p>

<span><a href="{{ url_for('rota.rota_by_time') }}">Rota by time</a></span>

<h2>Rota by recorder</h2>

<p>Provides a grid view with times down the left and recorders across the top, showing talk IDs in each cell. On its own page for ease of printing:</p>

<span><a href="{{ url_for('rota.rota_by_recorder') }}">Rota by recorder</a></span>

</div>

{% endblock %}
